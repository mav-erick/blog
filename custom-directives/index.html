<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Custom directives in Angular 6 — building a Google places autocomplete</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css?v=968d86cab0">

    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="The Code Journal">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Custom directives in Angular 6 — building a Google places autocomplete">
    <meta property="og:description" content="Final Project: http://ng-places-maverick.surge.sh/I have been playing around with Angular a lot lately and a lot of things that seemed unnecessary in the beginning is starting to make sense. Angular is a well thought out framework, and although it is very opinionated, it follows some of the">
    <meta property="og:url" content="http://localhost:2368/custom-directives/">
    <meta property="og:image" content="http://localhost:2368/content/images/2018/07/1_WNeChyJ5f8nwVue8hkZEPg-1.gif">
    <meta property="article:published_time" content="2018-07-22T13:57:00.000Z">
    <meta property="article:modified_time" content="2018-07-29T05:02:03.000Z">
    <meta property="article:tag" content="Angular">
    <meta property="article:tag" content="Custom-directives">
    <meta property="article:tag" content="JavaScript">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Custom directives in Angular 6 — building a Google places autocomplete">
    <meta name="twitter:description" content="Final Project: http://ng-places-maverick.surge.sh/I have been playing around with Angular a lot lately and a lot of things that seemed unnecessary in the beginning is starting to make sense. Angular is a well thought out framework, and although it is very opinionated, it follows some of the">
    <meta name="twitter:url" content="http://localhost:2368/custom-directives/">
    <meta name="twitter:image" content="http://localhost:2368/content/images/2018/07/1_WNeChyJ5f8nwVue8hkZEPg-1.gif">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Abhishek Menon">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Angular, Custom-directives, JavaScript">
    <meta property="og:image:width" content="525">
    <meta property="og:image:height" content="303">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "The Code Journal",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Abhishek Menon",
        "url": "http://localhost:2368/author/abhishek/",
        "sameAs": []
    },
    "headline": "Custom directives in Angular 6 — building a Google places autocomplete",
    "url": "http://localhost:2368/custom-directives/",
    "datePublished": "2018-07-22T13:57:00.000Z",
    "dateModified": "2018-07-29T05:02:03.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:2368/content/images/2018/07/1_WNeChyJ5f8nwVue8hkZEPg-1.gif",
        "width": 525,
        "height": 303
    },
    "keywords": "Angular, Custom-directives, JavaScript",
    "description": "Final Project: http://ng-places-maverick.surge.sh/I have been playing around with Angular a lot lately and a lot of things that seemed unnecessary in the beginning is starting to make sense. Angular is a well thought out framework, and although it is very opinionated, it follows some of the",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <script src="../public/ghost-sdk.js?v=968d86cab0"></script>
<script>
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "e693bfa48b4d"
});
</script>
    <meta name="generator" content="Ghost 1.25">
    <link rel="alternate" type="application/rss+xml" title="The Code Journal" href="../rss/index.html">

</head>
<body class="post-template tag-angular tag-custom-directives tag-javascript">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="../">The Code Journal</a>
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="../">Home</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
        </div>
            <a class="subscribe-button" href="index.html#subscribe">Subscribe</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-angular tag-custom-directives tag-javascript ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2018-07-22">22 July 2018</time>
                        <span class="date-divider">/</span> <a href="../tag/angular/">Angular</a>
                </section>
                <h1 class="post-full-title">Custom directives in Angular 6 — building a Google places autocomplete</h1>
            </header>

            <figure class="post-full-image" style="background-image: url(../content/images/2018/07/1_WNeChyJ5f8nwVue8hkZEPg-1.gif)">
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>Final Project: <a href="http://ng-places-maverick.surge.sh/" rel="nofollow noopener">http://ng-places-maverick.surge.sh/</a></p><p>I have been playing around with Angular a lot lately and a lot of things that seemed unnecessary in the beginning is starting to make sense. Angular is a well thought out framework, and although it is very opinionated, it follows some of the industry best practices when it comes to structuring the frontend of a web application. It was fascinating to discover how much focus is there on code reusability both within a project and across multiple projects! I would like to show you an example, using Angular directives.</p><h4 id="what-is-a-directive"><strong>What is a directive?</strong></h4><p>A directive allows you to attach a behavior to DOM elements. This behavior could be as simple or as complex as you’d like.<code>*ngFor</code> and <code>*ngIf</code> are examples of built-in directives in Angular. In this article, I will show you how to make a custom Google place autocomplete directive that you can attach to any text input.</p><h4 id="before-we-begin-">Before we begin…</h4><p>To use Google places autocomplete API, we need an API key. To obtain an API key, please go to the <a href="https://cloud.google.com/maps-platform/" rel="noopener">Google maps platform</a> and create a new project.</p><figure class="kg-image-card"><img src="../content/images/2018/07/1_qp5zCTTyarZExL0Rbfphog.png" class="kg-image"></figure><p>Once you signup, you can find your API key from the <a href="https://console.cloud.google.com/google/maps-apis/" rel="noopener">developer console</a>. Note this API key down for later.</p><h4 id="setting-up-an-angular-project">Setting up an Angular project</h4><p>Install <a href="https://nodejs.org/en/download/" rel="noopener">Node.js®</a> and npm if they are not already on your machine. Now, install Angular CLI globally using..</p><p><code>npm i -g @angular/cli</code></p><p>Once this is done, let’s create a new Angular project with the following command:</p><p><code>ng new google-places-example</code></p><p>Now go into your project directory and start the Angular development server:</p><pre><code>cd google-places-example
ng serve</code></pre><figure class="kg-image-card"><img src="../content/images/2018/07/1_6yJSVXv7ScPt6Lu4v851pA.png" class="kg-image"></figure><p>If you go to the server running at <code><a href="http://localhost:4200/">http://localhost:4200</a></code>, you will see the above screen.</p><p>Nice! Now let’s create an input field to which we will attach the Angular directive. Open the Angular project in your favorite text editor and open the file <code>src/app/app.component.html</code>.</p><p>Change the contents of the file to the following</p><script src="https://gist.github.com/mav-erick/45999203801cd477886666949cf34dba.js"></script><p>Now, let’s add some styling to make our input field look nice. Edit your <code>src/app/app.component.css</code> to the following</p><script src="https://gist.github.com/mav-erick/72af4514cf3c5e067d7e3f87940d9787.js"></script><p>After this, if you check your development server at <code><a href="http://localhost:4200/">http://localhost:4200</a></code>, you should see something like this.</p><figure class="kg-image-card"><img src="../content/images/2018/07/1_z0yHczug6VEvpM7pxzFBxA.png" class="kg-image"></figure><p>Nice, but “app” is a rather boring name for our app :D. Let’s give it a more descriptive name. Open <code>src/app/app.component.ts</code> and change the <code>title</code>variable to whatever you like. I am going to call my app “Places”.</p><figure class="kg-image-card"><img src="../content/images/2018/07/1_UQ0EHzlJBOaafj-6CvEshg.png" class="kg-image"></figure><p>Cool, now let’s start with the directive.</p><h4 id="generating-a-directive-using-angular-cli">Generating a directive using Angular CLI</h4><p><code>ng g d google-places</code></p><p>Here, ‘g’ is short for generate and ‘d’ is short for directive. This should generate two files in <code>src/app</code> called <code>google-places.directive.ts</code> and <code>google-places.directive.spec.ts</code>. All files ending with <code>spec.ts</code> are containers for writing unit tests.</p><p>When we place a directive in an element, we get access to a reference to that element in our directive. We will use this reference to attach the autocomplete functionality to the input element. Now, modify the <code>google-places.directive.ts</code> to the following</p><script src="https://gist.github.com/mav-erick/8ca63274a72b414322076b70bdd23d8d.js"></script><p>Please note that I have changed the name of the <code>selector</code> as I am not a fan of the autogenerated one. Here, we are getting access to the <code>ElementRef</code> made available to us via the constructor, and storing the <code>nativeElement</code> property into a variable, so that we can pass it to google places autocomplete constructor. Once you’re done, you have to modify the index.html found in <code>src</code> folder of your project to add the google places script. Place the following script between the <code>&lt;head&gt;</code> tag.</p><p><code>&lt;script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&amp;libraries=places" async defer&gt;&lt;/script&gt;</code></p><p>Replace YOUR_API_KEY with the API key you had noted down from earlier. Then, restart the Angular development server.</p><p>Now we need to add the directive to our input tag. Modify the <code>input</code> in <code>src/app/app.component.html</code> to the following</p><pre><code>&lt;input
  google-place
  type="text"
  class="google-place-input"
  placeholder="Type to search.."&gt;</code></pre><p>All the change we made was to add the directive selector to the input. Save the file, go to the development server and start typing. You should see the following..</p><figure class="kg-image-card"><img src="../content/images/2018/07/1_c8wheI3a9zROSFbJFDm9PA.png" class="kg-image"></figure><p>Viola! Now you have autocomplete on your very own input field. You can use this autocomplete directive as many times as you want, wherever you want!</p><h4 id="sending-events-from-the-directive">Sending events from the directive</h4><p>Now that we have an awesome autocomplete, we might want to send a formatted address instead of a string back to the input field. Let’s see how to do it.</p><p>Modify your <code>google-places.directive.ts</code> like so</p><script src="https://gist.github.com/mav-erick/861d5844817f464990fbbe34015c62d5.js"></script><p>We have done two things here:</p><ol><li>We created a function <code>getFormattedAddress</code> which takes a google place object as an argument and parses it to create a useful address object.</li><li>We added an event listener to the autocomplete API, which will fire every time the place is changed, and we are using this event listener to emit our own event which will parse the place object using the above <code>getFormattedAddress</code> and send the resulting address object back to the input element.</li></ol><p>We have exposed this event through an <code>onSelect</code> event emitter. Now let’s use this event emitter in our input.</p><p>Modify the <code>src/app/app.component.ts</code> to the following:</p><script src="https://gist.github.com/mav-erick/f3b8a3c130d73ca64252b1468370dc3a.js"></script><p>We have created a function called <code>setAddress</code> which we will call everytime the event emitter emits a new value. We will store the object received and its keys to display it back to the user. Now, let’s modify the <code>app.component.html</code>to consume the event and display the result:</p><script src="https://gist.github.com/mav-erick/5e1b67ef695be459db4748ba6b8ed283.js"></script><p>Check the development server and now we will see the following result:</p><figure class="kg-image-card"><img src="../content/images/2018/07/1_WNeChyJ5f8nwVue8hkZEPg.gif" class="kg-image"></figure><p>Awesome! We have created our very own custom google-place directive, which can provide autocomplete to any input field, and emit a formatted address object from the input field.</p><p>You can find this Angular project in my GitHub <a href="https://github.com/mav-erick/angular-google-places-autocomplete-directive" rel="noopener">repo</a>. Thanks for reading!</p>
                </div>
            </section>

            <section class="subscribe-form">
                <h3 class="subscribe-form-title">Subscribe to The Code Journal</h3>
                <p>Get the latest posts delivered right to your inbox</p>
                <form method="post" action="http://localhost:2368/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"><input class="location" type="hidden" name="location"><input class="referrer" type="hidden" name="referrer">

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email" placeholder="youremail@example.com">
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    
<script>
    (function(g,h,o,s,t){
        var buster = function(b,m) {
            h[o]('input.'+b).forEach(function (i) {
                i.value=i.value || m;
            });
        };
        buster('location', g.location.href);
        buster('referrer', h.referrer);
    })(window,document,'querySelectorAll','value');
</script>

</form>


            </section>

            <footer class="post-full-footer">


                    
<section class="author-card">
        <span class="avatar-wrapper"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"></path></g></svg>
</span>
    <section class="author-card-content">
        <h4 class="author-card-name"><a href="../author/abhishek/">Abhishek Menon</a></h4>
            <p>Read <a href="../author/abhishek/">more posts</a> by this author.</p>
    </section>
</section>
<div class="post-full-footer-right">
    <a class="author-card-button" href="../author/abhishek/">Read More</a>
</div>


            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">


                <article class="post-card post">
        <a class="post-card-image-link" href="../periodic-tor-ip-rotation-in-10-minutes/">
            <div class="post-card-image" style="background-image: url(../content/images/2018/07/1_rB3ohibjixfGBtmtQn40PQ.jpeg)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../periodic-tor-ip-rotation-in-10-minutes/">
            <header class="post-card-header">
                <h2 class="post-card-title">Periodic Tor IP Rotation in 10 minutes</h2>
            </header>
            <section class="post-card-excerpt">
                <p>The approachWe will set up Tor, create a proxy service to tunnel our requests through tor, and use the STEM library to rotate the IP periodically.DownloadsProxy Server: http://www.privoxy.org/Tor:</p>
            </section>
        </a>
        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Abhishek Menon
                    </div>

                        <a href="../author/abhishek/" class="static-avatar author-profile-image"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"></path></g></svg>
</a>
                </li>
            </ul>

            <span class="reading-time">2 min read</span>

        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="../">
            <span>The Code Journal</span>
        </a>
    </div>
    <span class="floating-header-divider">—</span>
    <div class="floating-header-title">Custom directives in Angular 6 — building a Google places autocomplete</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"></path>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Custom%20directives%20in%20Angular%206%E2%80%8A%E2%80%94%E2%80%8Abuilding%20a%20Google%20places%20autocomplete&amp;url=http://localhost:2368/custom-directives/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/custom-directives/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">The Code Journal</a> © 2018</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="index.html#"></a>
        <div class="subscribe-overlay-content">
            <h1 class="subscribe-overlay-title">Subscribe to The Code Journal</h1>
            <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
            <form method="post" action="http://localhost:2368/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"><input class="location" type="hidden" name="location"><input class="referrer" type="hidden" name="referrer">

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email" placeholder="youremail@example.com">
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    
<script>
    (function(g,h,o,s,t){
        var buster = function(b,m) {
            h[o]('input.'+b).forEach(function (i) {
                i.value=i.value || m;
            });
        };
        buster('location', g.location.href);
        buster('referrer', h.referrer);
    })(window,document,'querySelectorAll','value');
</script>

</form>


        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=968d86cab0"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();

});
</script>


    

</body>
